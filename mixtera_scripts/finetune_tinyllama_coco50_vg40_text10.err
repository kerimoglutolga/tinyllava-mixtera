2025-01-30 08:22:54.996 | INFO     | __main__:main:46 - Starting server, serving from directory /iopsstor/scratch/cscs/tkerimog/tinyllava/mixtera_server_2
2025-01-30 08:22:55.000 | DEBUG    | mixtera.core.client.mixtera_client:__init__:138 - Initialized current mixture id to -1.
2025-01-30 08:22:55.002 | INFO     | mixtera.core.datacollection.mixtera_data_collection:_load_db_from_disk:76 - Loading database from /iopsstor/scratch/cscs/tkerimog/tinyllava/mixtera_server_2/mixtera.duckdb
2025-01-30 08:22:55.032 | INFO     | mixtera.core.datacollection.mixtera_data_collection:_load_db_from_disk:78 - Database loaded.
2025-01-30 08:22:55.046 | INFO     | mixtera.core.datacollection.mixtera_data_collection:_vacuum:123 - Vacuuming the DuckDB.
2025-01-30 08:22:55.046 | INFO     | mixtera.core.datacollection.mixtera_data_collection:_vacuum:125 - Vacuumd.
2025-01-30 08:22:55.047 | DEBUG    | mixtera.core.query.query_cache:__init__:18 - Initializing QueryCache at /iopsstor/scratch/cscs/tkerimog/tinyllava/mixtera_server_2/querycache
2025-01-30 08:22:55.056 | INFO     | mixtera.network.server.server:_run_async:377 - Serving MixteraServer on ('172.28.49.127', 12345)
2025-01-30 08:23:44.975 | DEBUG    | mixtera.core.client.mixtera_client:__init__:138 - Initialized current mixture id to -1.
2025-01-30 08:23:44.975 | DEBUG    | mixtera.core.client.mixtera_client:__init__:138 - Initialized current mixture id to -1.
2025-01-30 08:23:44.975 | DEBUG    | mixtera.core.client.mixtera_client:__init__:138 - Initialized current mixture id to -1.
2025-01-30 08:23:44.977 | DEBUG    | mixtera.torch.mixtera_torch_dataset:_init_status_shm:163 - [Process 21599] Created shared memory objects for 8 workers
2025-01-30 08:23:44.977 | DEBUG    | mixtera.torch.mixtera_torch_dataset:_init_status_shm:163 - [Process 21598] Created shared memory objects for 8 workers
2025-01-30 08:23:44.977 | INFO     | mixtera.torch.mixtera_torch_dataset:__init__:85 - [21598/21598] Since this is node 0 in data parallel group 0, executing query!
2025-01-30 08:23:44.977 | DEBUG    | mixtera.torch.mixtera_torch_dataset:_init_status_shm:163 - [Process 21600] Created shared memory objects for 8 workers
2025-01-30 08:23:44.985 | DEBUG    | mixtera.network.server.server:_register_query:61 - Received register query request
2025-01-30 08:23:44.986 | DEBUG    | mixtera.network.server.server:_register_query:63 - mixture = {"mixture": {dataset:coco: 128, dataset:vg: 102, dataset:text: 26}, "chunk_size": 256}
2025-01-30 08:23:44.986 | DEBUG    | mixtera.network.server.server:_register_query:74 - Received query = select<>([('dataset', '!=', 'LLAVA_PRETRAIN')]). Executing it.
2025-01-30 08:23:44.986 | DEBUG    | mixtera.core.query.query_cache:get_queryresults_if_cached:68 - No directory found at /iopsstor/scratch/cscs/tkerimog/tinyllava/mixtera_server_2/querycache/b9a9a716a66a21cbe73839d29d139fcd571897016352f70ec824693587a2bf72 for query with hash b9a9a716a66a21cbe73839d29d139fcd571897016352f70ec824693587a2bf72.
2025-01-30 08:23:44.987 | DEBUG    | mixtera.core.query.query:execute:80 - Executing query locally with chunk size 256
2025-01-30 08:23:44.990 | DEBUG    | mixtera.core.query.query:execute:102 - {'dataset_id': {'type': 'INTEGER', 'multiple': False, 'nullable': False}, 'file_id': {'type': 'INTEGER', 'multiple': False, 'nullable': False}, 'sample_id': {'type': 'INTEGER', 'multiple': False, 'nullable': False}, 'dataset': {'type': 'VARCHAR', 'multiple': False, 'nullable': True}}
2025-01-30 08:23:44.990 | DEBUG    | mixtera.core.query.query:execute:104 - SQL:
SELECT * FROM samples WHERE (dataset != ?)
Parameters:
['LLAVA_PRETRAIN']
2025-01-30 08:23:45.153 | DEBUG    | mixtera.core.client.mixtera_client:__init__:138 - Initialized current mixture id to -1.
2025-01-30 08:23:45.158 | DEBUG    | mixtera.torch.mixtera_torch_dataset:_init_status_shm:163 - [Process 21601] Created shared memory objects for 8 workers
2025-01-30 08:23:45.639 | DEBUG    | mixtera.core.query.query_result:__init__:60 - Instantiating QueryResult..
2025-01-30 08:23:45.640 | DEBUG    | mixtera.core.query.query_result:__init__:61 - Creating chunker index.
2025-01-30 08:23:45.640 | INFO     | mixtera.core.query.query_result:_create_chunker_index:172 - Converting to chunker index structure...
2025-01-30 08:23:45.695 | DEBUG    | mixtera.core.query.query_result:__init__:63 - Chunker index created, informing mixture and parsing metadata.
2025-01-30 08:23:45.710 | DEBUG    | mixtera.core.query.query_result:_update_key_id_map:110 - Updated key-id-map:
{dataset:coco: 0, dataset:gqa: 1, dataset:ocr_vqa: 2, dataset:text: 3, dataset:textvqa: 4, dataset:vg: 5}

2025-01-30 08:23:45.710 | DEBUG    | mixtera.core.query.query_result:__init__:83 - QueryResult instantiated.
2025-01-30 08:23:45.711 | DEBUG    | mixtera.core.query.query:execute:159 - Results:
<mixtera.core.query.query_result.QueryResult object at 0x40019cc44cd0>
2025-01-30 08:23:45.711 | DEBUG    | mixtera.core.query.query:execute:160 - Query executed.
2025-01-30 08:23:45.717 | INFO     | mixtera.core.query.query_result:to_cache:568 - Starting to cache QueryResult.
2025-01-30 08:23:45.717 | DEBUG    | mixtera.core.query.query_result:to_cache:575 - Removed unpickable attributed.
2025-01-30 08:23:45.717 | DEBUG    | mixtera.core.query.query_result:to_cache:583 - Removed dillable attributes.
2025-01-30 08:23:45.719 | DEBUG    | mixtera.core.query.query_result:to_cache:588 - Stored dillable attributes.
2025-01-30 08:23:45.720 | DEBUG    | mixtera.core.query.query_result:to_cache:593 - Stored pickable attributes.
Preparing tasks per mixture key.:   0%|          | 0/6 [00:00<?, ?it/s]Preparing tasks per mixture key.: 100%|██████████| 6/6 [00:00<00:00, 567.83it/s]
Serializing Files (using 6 cores):   0%|          | 0/6 [00:00<?, ?it/s]Serializing Files (using 6 cores): 100%|██████████| 6/6 [00:00<00:00, 1007.04it/s]
2025-01-30 08:23:45.811 | DEBUG    | mixtera.core.query.query_result:to_cache:597 - Stored chunker index.
2025-01-30 08:23:45.811 | DEBUG    | mixtera.core.query.query_cache:cache_query:54 - QueryResult saved to /iopsstor/scratch/cscs/tkerimog/tinyllava/mixtera_server_2/querycache/b9a9a716a66a21cbe73839d29d139fcd571897016352f70ec824693587a2bf72/0
2025-01-30 08:23:45.812 | DEBUG    | mixtera.core.query.chunk_distributor:__init__:53 - [20255/20255] Instantiating ChunkDistributor for job mixtera_tinyllava_20250130_082251
2025-01-30 08:23:45.812 | INFO     | mixtera.core.client.local.local_stub:_register_query:166 - Registered query select<>([('dataset', '!=', 'LLAVA_PRETRAIN')]) for job mixtera_tinyllava_20250130_082251, with mixture {"mixture": {dataset:coco: 128, dataset:vg: 102, dataset:text: 26}, "chunk_size": 256}
2025-01-30 08:23:45.812 | DEBUG    | mixtera.network.server.server:_register_query:77 - Registered query with success = True and executed it.
2025-01-30 08:23:45.813 | DEBUG    | mixtera.network.connection.server_connection:_execute_query:162 - Got success = True from server.
2025-01-30 08:23:45.814 | INFO     | mixtera.core.client.server.server_stub:execute_query:72 - Registered query for job mixtera_tinyllava_20250130_082251 at server!
